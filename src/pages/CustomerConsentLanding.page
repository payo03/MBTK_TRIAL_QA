<!--
 * @author : chaebeom.do
 * @date : 2024-12-30
 * @description : 개인정보동의 랜딩페이지에 사용되는 Visualforce 페이지
 * @target : 
==============================================================
 * Ver          Date            Author          Modification
 * 1.0          2024-12-30      chaebeom.do     Created
 * 1.1          2025-01-06      San.Kang        Updated
-->
<apex:page controller="LandingPageController" lightningStylesheets="true" action="{!getCustomerConsent}" showHeader="false">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1"></meta> 
    <apex:slds />
    <style type="text/css">
      @media (max-width: 575px){
        .mainContent {
          padding-left: 30px; 
          padding-right: 30px;
        }
        /* .mobile {
          display: flex; 
          justify-content: flex-end;
        } */
      }
      @media (min-width: 1200px){
        .mainContent {
          padding-left: 450px; 
          padding-right: 450px;
        }
      }
    </style>
  </head>
  <body>
    <apex:image url="{!$Resource.landingPageHeaderTest}" width="100%" style="margin-bottom: 30px;"/>
    <div class="mainContent">
      <div class="slds-clearfix">
        <h1 class="slds-text-heading_large slds-float_left slds-m-right_x-large" style="font-weight: bold;">개인정보수집·이용·제공동의</h1>
        <div class="slds-checkbox slds-float_left slds-p-top_x-small">
          <input type="checkbox" id="checkbox-agree-all" onclick="selectAllCheck(this)"/>
          <label class="slds-checkbox__label" for="checkbox-agree-all">
            <span class="slds-checkbox_faux"></span>
            <span class="slds-form-element__label">전체동의</span>
          </label>
        </div>
      </div>
      <hr></hr>
      <div class="slds-grid slds-wrap slds-m-around_xx-small">
        <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
          <span>개인정보 수집 및 이용동의(필수)<p style="display: inline; color: #00BFFF; font-weight: bold;">*</p></span>
        </div>
        <div class="slds-grid slds-size_1-of-1 slds-large-size_1-of-2">
          <div class="slds-checkbox slds-col">
            <input type="checkbox" name="checkbox" id="checkbox-unique-1-agree" class="agree box-1" onclick="checkAsRadio(this)"/>
            <label class="slds-checkbox__label" for="checkbox-unique-1-agree">
              <span class="slds-checkbox_faux"></span>
              <span class="slds-form-element__label">동의</span>
            </label>
          </div>
          <div class="slds-checkbox slds-col">
            <input type="checkbox" name="checkbox" id="checkbox-unique-1-disagree" class="disagree box-1" onclick="checkAsRadio(this)"/>
            <label class="slds-checkbox__label" for="checkbox-unique-1-disagree">
              <span class="slds-checkbox_faux"></span>
              <span class="slds-form-element__label">동의안함</span>
            </label>
          </div>
          <button class="slds-button slds-button_neutral" onClick="openModal('버튼 1')">자세히 보기</button>
        </div>
      </div>
      <div class="slds-grid slds-wrap slds-m-around_xx-small">
        <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
          <span>개인정보 제3자 제공 동의(필수)<p style="display: inline; color: #00BFFF; font-weight: bold;">*</p></span>
        </div>
        <div class="slds-grid slds-size_1-of-1 slds-large-size_1-of-2">
          <div class="slds-checkbox slds-col">
            <input type="checkbox" name="checkbox" id="checkbox-unique-2-agree" class="agree box-2" onclick="checkAsRadio(this)"/>
            <label class="slds-checkbox__label" for="checkbox-unique-2-agree">
              <span class="slds-checkbox_faux"></span>
              <span class="slds-form-element__label">동의</span>
            </label>
          </div>
          <div class="slds-checkbox slds-col">
            <input type="checkbox" name="checkbox" id="checkbox-unique-2-disagree" class="disagree box-2" onclick="checkAsRadio(this)"/>
            <label class="slds-checkbox__label" for="checkbox-unique-2-disagree">
              <span class="slds-checkbox_faux"></span>
              <span class="slds-form-element__label">동의안함</span>
            </label>
          </div>
          <button class="slds-button slds-button_neutral" onClick="openModal('버튼 2')">자세히 보기</button>
        </div>
      </div>
      <div class="slds-grid slds-wrap slds-m-around_xx-small">
        <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
          <span>개인정보 마케팅목적 수집 및 이용 동의(선택)</span>
        </div>
        <div class="slds-grid slds-size_1-of-1 slds-large-size_1-of-2">
          <div class="slds-checkbox slds-col">
            <input type="checkbox" name="checkbox" id="checkbox-unique-3-agree" class="agree box-3" onclick="checkAsRadio(this)"/>
            <label class="slds-checkbox__label" for="checkbox-unique-3-agree">
              <span class="slds-checkbox_faux"></span>
              <span class="slds-form-element__label">동의</span>
            </label>
          </div>
          <div class="slds-checkbox slds-col">
            <input type="checkbox" name="checkbox" id="checkbox-unique-3-disagree" class="disagree box-3" onclick="checkAsRadio(this)"/>
            <label class="slds-checkbox__label" for="checkbox-unique-3-disagree">
              <span class="slds-checkbox_faux"></span>
              <span class="slds-form-element__label">동의안함</span>
            </label>
          </div>
          <button class="slds-button slds-button_neutral" onClick="openModal('버튼 3')">자세히 보기</button>
        </div>
      </div>
      <div class="slds-col slds-size_1-of-1 slds-align_absolute-center">
        <button class="slds-button slds-button_brand" onclick="saveConsent('{!Id}')">제출</button>
      </div>

    </div>

    <!--MODAL 1 START --> 
    <div id="id01" style="display: none;">
      <section role="dialog" tabindex="1" aria-labelledby="modal-heading" aria-hidden="true" aria-describedby="modal-content"
        class="slds-modal slds-fade-in-open slds-modal_medium">
        <div class="slds-modal__container">
          <button class="slds-button slds-button_icon slds-modal__close" onclick="document.getElementById('id01').style.display='none'">
            <svg aria-hidden="true" class="slds-button__icon slds-button__icon_large" style="background: white; border-radius: 5px;">
              <use href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
            </svg>
            <span class="slds-assistive-text">Cancel and close</span>
          </button>
          <header class="slds-modal__header slds-p-around_large">
            <h2 id="modal-heading1" class="slds-text-heading_medium slds-hyphenate">제목</h2>
          </header>
          <div class="slds-modal__content slds-p-around_xx-large" id="modal-content">
            <div class="slds-align_absolute-center">
              <h2>수집하는 개인정보 항목</h2>
            </div>
            <div class="slds-p-around_small">
              <p>성명, 출생년도, 연락처(휴대전화번호), 연계정보(CI), 차량구매계획, 
                관심차종(모델명), 상담 (희망) 대리점, 상담 희망일, 상담유형, 
                서비스 품질향상 조사 결과, 고객만족도 조사 결과, 고객불만 등 민원사항, 민원이력</p>
            </div>
            <div class="slds-align_absolute-center">
              <h2>개인정보의 수집·이용 목적</h2>
            </div>
            <div class="slds-p-around_small">
              <p>상담신청 의사의 확인 및 담당 딜러사 매칭을 위한 연락, 
                상담 서비스 제공, 신청자/예약자 식별 및 본인 확인, 
                차량 사전 예약을 위한 예약금 결제 및 서비스의 제공, 분쟁 발생 시를 대비한 기록보존, 
                불만처리 등 민원응대, 각종 고지사항 전달, 서비스 품질 향상 조사, 고객만족도 조사, 통계분석, 
                (이벤트 진행 시) 경품 추첨 및 배송</p>
            </div>
            <div class="slds-align_absolute-center">
              <h2>개인정보의 보유·이용기간</h2>
            </div>
            <div class="slds-p-around_small">
              <p>관련 법령상 보존의무가 있는 경우가 아닌 한 상담 신청일로부터 1년간 보관합니다.</p>
            </div>
            <div class="slds-align_absolute-center">
              <h2>거부권 및 거부 시 불이익</h2>
            </div>
            <div class="slds-p-around_small">
              <p>귀하는 위와 같은 개인정보 수집·이용에 동의하지 않을 수 있으나, 동의거부 시 상담 서비스 등 위 개인정보의 수집·이용 목적에 기재된 서비스의 제공이 제한될 수 있습니다.</p>
            </div>
          </div>
        </div>
      </section>
      <div class="slds-backdrop slds-backdrop_open"></div>
    </div>
    <!--MODAL 1 END -->

    <!--MODAL 2 START --> 
    <div id="id02" style="display: none;">
      <section role="dialog" tabindex="1" aria-labelledby="modal-heading" aria-hidden="true" aria-describedby="modal-content"
        class="slds-modal slds-fade-in-open slds-modal_medium">
        <div class="slds-modal__container">
          <button class="slds-button slds-button_icon slds-modal__close" onclick="document.getElementById('id02').style.display='none'">
            <svg aria-hidden="true" class="slds-button__icon slds-button__icon_large" style="background: white; border-radius: 5px;">
              <use href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
            </svg>
            <span class="slds-assistive-text">Cancel and close</span>
          </button>
          <header class="slds-modal__header slds-p-around_large">
            <h2 id="modal-heading2" class="slds-text-heading_medium slds-hyphenate">제목</h2>
          </header>
          <div class="slds-modal__content slds-p-around_xx-large" id="modal-content">
            <div class="slds-align_absolute-center">
              <h2>제공받는 자(연락처)</h2>
            </div>
            <div class="slds-p-around_small">
              <p>OO모터스(000-0000-0000)</p>
            </div>
            <div class="slds-align_absolute-center">
              <h2>소재국가</h2>
            </div>
            <div class="slds-p-around_small">
              <p>한국</p>
            </div>
            <div class="slds-align_absolute-center">
              <h2>제공받는 자의 개인정보 이용목적</h2>
            </div>
            <div class="slds-p-around_small">
              <p>상담 서비스 제공, 신청자 식별 및 본인 확인, 분쟁 발생 시를 대비한 기록보존, 불만처리 등 민원응대, 각종 고지사항 전달, 서비스품질향상 조사, 고객만족도조사, 통계분석, (이벤트 진행 시) 경품 추첨 및 배송</p>
            </div>
            <div class="slds-align_absolute-center">
              <h2>제공하는개인정보 항목</h2>
            </div>
            <div class="slds-p-around_small">
              <p>성명, 출생년도, 연락처(휴대전화번호), 차량구매계획, 관심차종(모델명), 시승 및 상담 (희망) 전시장, 시승 및 상담 희망일, 상담유형, 서비스 품질향상 조사 결과, 고객만족도 조사 결과, 고객불만 등 민원사항, 민원이력</p>
            </div>
            <div class="slds-align_absolute-center">
              <h2>제공받는 자의 개인정보 보유·이용기간</h2>
            </div>
            <div class="slds-p-around_small">
              <p>관련 법령상 보존의무가 있는 경우가 아닌 한 상담 신청일로부터 1년</p>
            </div>
          </div>
        </div>
      </section>
      <div class="slds-backdrop slds-backdrop_open"></div>
    </div>
    <!--MODAL 2 END -->

    <!--MODAL 3 START --> 
    <div id="id03" style="display: none;">
      <section role="dialog" tabindex="1" aria-labelledby="modal-heading" aria-hidden="true" aria-describedby="modal-content"
        class="slds-modal slds-fade-in-open slds-modal_medium">
        <div class="slds-modal__container">
          <button class="slds-button slds-button_icon slds-modal__close" onclick="document.getElementById('id03').style.display='none'">
            <svg aria-hidden="true" class="slds-button__icon slds-button__icon_large" style="background: white; border-radius: 5px;">
              <use href="{!URLFOR($Asset.SLDS, 'assets/icons/utility-sprite/svg/symbols.svg#close')}"></use>
            </svg>
            <span class="slds-assistive-text">Cancel and close</span>
          </button>
          <header class="slds-modal__header slds-p-around_large">
            <h2 id="modal-heading3" class="slds-text-heading_medium slds-hyphenate">제목</h2>
          </header>
          <div class="slds-modal__content slds-p-around_xx-large" id="modal-content">
            <p>위 1.항과 같이 동의를 받아 수집한 귀하의 개인정보는 위 1.항 기재 보유·이용기간 중에 문자메시지(SMS, 카카오톡 등), 전화, 이메일, 우편을 통하여 만트럭 제품 및 브랜드 관련 정보(뉴스레터/카탈로그 포함), 향후 진행될 프로모션 및 이벤트 정보(각종 할인 이벤트 포함) 등의 전달 등 마케팅 목적으로 이용될 수 있습니다.귀하는 이러한 개인정보 수집·이용에 대해 동의하지 않을 수 있고 이는 MTBK의 상담 서비스 제공에 영향을 미치지 않습니다. 다만 동의거부 시 MTBK로부터 유용한 정보를 제공받지 못하실 수 있습니다.</p>
          </div>
        </div>
      </section>
      <div class="slds-backdrop slds-backdrop_open"></div>
    </div>
    <!--MODAL 3 END -->
    

    <script type="text/javascript">
      function openModal(title) {
        if (title == '버튼 1') {
          document.getElementById('modal-heading1').innerText = '만트럭버스코리아 주식회사(이하 "MTBK")는 귀하에게 상담 서비스를 제공하기 위하여 아래와 같이 개인정보를 수집 및 이용합니다.';
          document.getElementById('id01').style.display = 'block';
        } else if (title == '버튼 2') {
          document.getElementById('modal-heading2').innerText = 'MTBK는 귀하에 대한 상담 서비스 제공을 위하여 아래와 같이 개인정보를 딜러사에 제공합니다. 귀하는 아래의 개인정보 제3자 제공에 대해 동의하지 않을 수 있으나, 동의 거부 시 시승 및 상담 서비스 등 아래 ‘제공받는 자의 개인정보 이용목적’ 항목에 기재된 서비스의 제공이 제한될 수 있습니다.';
          document.getElementById('id02').style.display = 'block';
        } else if (title == '버튼 3') {
          document.getElementById('modal-heading3').innerText = '';
          document.getElementById('id03').style.display = 'block';
        }
      }

      function selectAllCheck(selectAll) {
        // Switch all checkboxes
        var inputs = document.getElementsByTagName("input");
        var checked = selectAll.checked;
        for (var i = 0; i < inputs.length; i++) {
            if (inputs[i].type == "checkbox" && inputs[i].classList.contains("agree")) {
              inputs[i].checked = checked;
            }
            if (inputs[i].type == "checkbox" && inputs[i].classList.contains("disagree")) {
              inputs[i].checked = false;
            }
        }
      }

      function checkAsRadio(select) {
        var allCheck = document.getElementById("checkbox-agree-all");
        allCheck.checked = false;
        var classNo;
        if (select.classList.contains("box-1")){
          classNo = "box-1";
        } else if (select.classList.contains("box-2")){
          classNo = "box-2";
        } else {
          classNo = "box-3";
        }
        var inputs = document.getElementsByClassName(classNo);
        for (var i = 0; i < inputs.length; i++) {
          if (inputs[i] != select){
            inputs[i].checked = false;
          }
        }
      }

      function saveConsent(ccId) {
        var checkList = [];
        var ccChecked = document.getElementsByName("checkbox");
        ccChecked.forEach(element => {
          if(element.classList.contains("agree")) {
            checkList.push(element.checked);
          }
        });
        // 필수항목 체크 alert 코드 추가
        if(checkList[0] != true || checkList[1] != true){
           alert('필수 항목을 확인 해주세요.');
        }else{
          Visualforce.remoting.Manager.invokeAction(
          '{!$RemoteAction.LandingPageController.updateCustomerConsent}',
          ccId,
          checkList,
          function (result, event) {
              if (event.status) {
                console.log(result);
                alert('응답해주셔서 감사합니다.');
              } else {
                console.log('Error calling Apex!');
                alert('담당자에게 문의하시기 바랍니다.');
              }
          });
        }
      }
    </script>
  </body>
</apex:page>